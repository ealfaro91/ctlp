<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="456" inherit_id="l10n_mx_edi.report_invoice_document">
            <xpath expr="//div[hasclass('page')]" position="inside">
                <br/>
                <br/>
                <table t-if="o.invoice_payment_term_id">
                    <thead>
                        <tr>
                            <th>1.-APARTADO</th>
                            <th colspan="2">______FECHA_____</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-set="value_balance" t-value="o.amount_total"/>
                        <tr t-foreach="o.invoice_payment_term_id.line_ids" t-as="l">
                            <t t-if="l.option =='day_after_invoice_date'">
                                <td>
                                    <span t-esc="o.invoice_date + datetime.timedelta(days=l.days)"/>
                                </td>
                            </t>
                            <t t-if="l.option =='day_following_month'">
                                <t t-if="not o.invoice_date.year==12">
                                    <td>
                                        <span t-esc="o.invoice_date.year"/>
                                        <span>-</span>
                                        <span t-esc="'{0:02d}'.format(o.invoice_date.month+1)"/>
                                        <span>-</span>
                                        <span t-esc="'{0:02d}'.format(l.days)"/>
                                    </td>
                                </t>
                                <t t-if="o.invoice_date.year==12">
                                    <td>
                                        <span t-esc="o.invoice_date.year+1"/>
                                        <span>-01-</span>
                                        <span t-esc="'{0:02d}'.format(l.days)"/>
                                    </td>
                                </t>
                            </t>
                            <t t-if="l.option =='day_current_month'">
                                <td>
                                    <span t-esc="o.invoice_date.year"/>
                                    <span>-</span>
                                    <span t-esc="'{0:02d}'.format(o.invoice_date.month)"/>
                                    <span>-</span>
                                    <span t-esc="'{0:02d}'.format(l.days)"/>
                                </td>
                            </t>
                            <t t-set="value_porcentage" t-value="l.value_amount*o.amount_total/100"/>
                            <t t-if="l.value == 'fixed'">
                                <t t-set="value_balance" t-value="value_balance-l.value_amount"/>
                                <td > <span t-field="l.value_amount"/>  </td>
                            </t>
                            <t t-if="l.value == 'percent'">
                                <t t-set="value_balance" t-value="value_balance-value_porcentage"/>
                                <td > <span t-esc="value_porcentage"/>  </td>
                            </t>
                            <t t-if="l.value == 'balance'">
                                <td > <span t-esc="value_balance"/>  </td>
                            </t>
                        </tr>
                    </tbody>
                </table>
            </xpath>
        </template>
    </data>
</odoo>
